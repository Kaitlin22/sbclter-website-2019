// Javascript for creating google maps
// Loads the kml layers

var map;
var site_url = 'http://sbc.lternet.edu/';
var layers = {};  // Holds all layer objects that map to URL's

function initMap() {
	// Get all checkboxes on the screen
	// Boxes generated by sampling data layers
	var boxes = document.getElementsByClassName("layer_box");

	// Set up the google map
	map = new google.maps.Map(document.getElementById("map"),
		{
		center:new google.maps.LatLng(34.3, - 120.000),
		zoom: 9,
		mapTypeId: google.maps.MapTypeId.TERRAIN
		}
	);

	// Create all url's for the data layers
	for(var i=0; i < boxes.length; i++){
		layer_url = site_url + "kml/sampling/layers/" + boxes[i].id + ".kml";

		layers[boxes[i].id] = new google.maps.KmlLayer(layer_url, {
			preserveViewport: false,
			map: null
		})
	}

}


// Display the layer with the given id on the map
function show_layer(id){
	layers[id].setMap(map);
}

// Hide the layer with given id on the map
function hide_layer(id){
	layers[id].setMap(null);
}

// Tracks changes to any of the boxes on the page
// This will toggle the boxes layer on the map
$('.layer_box').change(function() {
	if(this.checked){  // Show
		show_layer(this.id);
	}else{  // Hide
		hide_layer(this.id);
	}
})