<div class="pull-left">
  <br>
  <table class="table">
    <thead id="table_header_{{include.data.name}}">
      <tr class="title-row">
        {% for column in include.columns %}
          <th>{{ column }}</th>
        {% endfor %}
      </tr>
    </thead>
    <tbody id="myTable">
      {% for group in include.data %}
        {% assign has_header = 0 %}

        {% for itemrow in group.items %}
          <tr class="hover_row">
            {% assign prev_index = forloop.index | minus: 2 %}

            <!-- Keep non-duplicated measurement rows -->
            {% if group.items[prev_index].id != itemrow.id %}

              <!-- Habitat header -->
              {% if has_header != 1 %}
                <th id="{{ itemrow.habitatName }}-habitat" style=" vertical-align: middle; text-align: center;" rowspan="{{group.items | size}}">
                  <h3>{{itemrow["habitatLabel"]}}</h3>
                  <input type="checkbox" data-toggle="toggle" data-onstyle="success" data-offstyle="secondary" class="group-toggle" id="{{ itemrow.habitatName }}"/>
                </th>

                {% assign has_header = 1 %}
              {% endif %}

              <!-- Measurement column -->
              <td id="{{ itemrow.habitatName }}-{{ itemrow.id }}-measurement">
                {{ itemrow[include.dataFilter] }}
                <br>
                <a class="collection-btn" href="#"> Access data </a>
              </td>

              <!-- Frequency column -->
              <td>{{ itemrow.frequency }}</td>

              <!-- Initiated column -->
              <td>{{ itemrow.initiated }}</td>

              <!-- Display column -->
              <td>
                <input type="checkbox" data-toggle="toggle" data-onstyle="success" data-offstyle="secondary" class="layer_box chkbox_{{ itemrow.habitatName }}" id="{{ itemrow.habitatName }}-{{ itemrow.id }}"/>
              </td>
            {% endif %}

            <!-- Store geodata and collection data for JavaScript processing -->
            <td class="hidden">
              <div class="{{ itemrow.habitatName }}-{{itemrow.id}}-geodata-list">
                {% for geodata in itemrow.geodata %}
                  <div class="geodata"
                       data-title="{{ geodata.title }}"
                       data-description="{{ geodata.description }}"
                       data-habitat="{{ itemrow.habitatLabel }}"
                       data-southbound="{{ geodata.southbound }}"
                       data-northbound="{{ geodata.northbound }}"
                       data-westbound="{{ geodata.westbound }}"
                       data-eastbound="{{ geodata.eastbound }}">
                  </div>
                {% endfor %}
              </div>

              <div class="{{ itemrow.habitatName }}-{{itemrow.id}}-package-list" data-collection="{{ itemrow.collectionName }}">
                {% for package in itemrow.packages.package %}
                  <div class="package"
                       data-docid="{{ package.docid }}"
                       data-shorttitle="{{ package.shortTitle }}">
                  </div>
                {% endfor %}
              </div>
            </td>

          </tr>
        {% endfor %}

      {% endfor %}
    </tbody>
  </table>
</div>

<!-- Popup Modal -->
<div id="layer-modal" class="modal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-body">
      </div>
    </div>
  </div>
</div>